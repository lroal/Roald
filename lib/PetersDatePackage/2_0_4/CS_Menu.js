// Copyright 2002 - 2007 Peter L. Blum, All Rights Reserved, www.PeterBlum.com
// Peter's Date Package Release 2.0.4
var gPDPMenuToken1=null;var gPDPMenuToken2=null;var gPDPMenuOpen=false;function PM_OnPopup(pE){var vCM=null;var vT=pE?pE.target:window.event.srcElement;for(var vSE=vT;(vSE!=document)&&(vSE!=null)&&!vCM;vSE=vSE.parentNode){if(vSE.CM)vCM=vSE.CM;}if(!vCM)return;var vLBtn=0;if(!pE){pE=window.event;vLBtn=1;}else if(gPDP_Safari)vLBtn=1;var vBtn=pE.button;if(((vCM.BT=="left")&&(vBtn!=vLBtn))||((vCM.BT=="right")&&(vBtn!=2)))return;PDP_StopEvent(pE);PM_InitSize(PDP_GetById(vCM.CMID));gPDPMenuToken1=vCM.Var1;gPDPMenuToken2=vCM.Var2;if(vCM.EFnc)for(var vI=0;vI<vCM.Items.length;vI++)PDP_GetById(vCM.CMID+"_TR_"+vI).style.display=vCM.EFnc(vCM.CMID,vCM.Items[vI])?"block":"none";if((vBtn==2)||(vCM.ID==""))PDP_OpenPopupAtMousePoint(vCM.CMID,pE);else PDP_OpenPopup(vCM.ID,vCM.CMID,true);gPDPMenuOpen=true;}function PM_ForcePopup(pCM){PM_InitSize(PDP_GetById(pCM.CMID));gPDPMenuToken1=pCM.Var1;gPDPMenuToken2=pCM.Var2;if(pCM.EFnc)for(var vI=0;vI<pCM.Items.length;vI++)PDP_GetById(pCM.CMID+"_TR_"+vI).style.display=pCM.EFnc(pCM.CMID,pCM.Items[vI])?"block":"none";PDP_OpenPopup(pCM.ID,pCM.CMID,true);}function PM_Initialize(pID,pCM,pICB){if(pCM.ID=="")PM_InitBody(pCM,document.body);else{if(!pICB){var vPUC=PDP_GetById(pCM.CMID);PDP_RelocatePopup(vPUC);vPUC=PDP_GetById(pCM.CMID);vPUC.IsPopup=true;}var vTB=PDP_GetById(pCM.ID);if(vTB)PM_InitBody(pCM,vTB);else{var vL=window.gPM_DelayList;if(!window.gPM_DelayList){vL=window.gPM_DelayList=new Array;if(pICB)window.setTimeout("PM_DelayInit();",100);else PDP_AttachEvent(document.body,"onload","PM_DelayInit();",false);}vL[vL.length]=pCM;}}}function PM_DelayInit(){var vL=window.gPM_DelayList;for(var vI=0;vI<vL.length;vI++){var vCM=vL[vI];var vTB=PDP_GetById(vCM.ID);if(vTB)PM_InitBody(vCM,vTB);}window.gPM_DelayList=null;}function PM_InitBody(pCM,pTB){pTB.CM=pCM;var vPUC=PDP_GetById(pCM.CMID);vPUC.PO.onpopdown="gPDPMenuOpen=false;"+(vPUC.PO.onpopdown?vPUC.PO.onpopdown:"");if(pTB.attachEvent&&!gPDP_Opera7){pTB.attachEvent("onmouseup",new Function("PM_OnPopup(null);"));if(pCM.BT=="right"){if(pCM.ID=="")pTB.oncontextmenu=new Function("return false;");else document.attachEvent("oncontextmenu",PM_TestContext);}}else if(pTB.addEventListener){if(gPDP_OS=="Mac")pTB.addEventListener("mousedown",PM_OnPopup,false);else pTB.addEventListener("mouseup",PM_OnPopup,false);if(pCM.BT=="right"){document.oncontextmenu=PM_TestContext;}}else if(gPDP_IEMac&&(pTB!=document.body)&&(pCM.BT=="left")){pTB.onclick=new Function("PDP_OpenPopup('"+pCM.ID+"','"+pCM.CMID+"',true);");}else return;}function PM_InitSize(pFld){if(pFld.Inited)return;var vIT=PDP_GetById(pFld.id+"_MenuTable");vT=vIT.offsetWidth;if(vIT.offsetWidth+4>pFld.offsetWidth){var vT=vT+4;pFld.style.width=vT+"px";}if(!gPDP_IEWin){var vHrs=pFld.getElementsByTagName("hr");if(vHrs){if(gPDP_Opera7){var vCM=PDP_GetById(pFld.id);var vLB=PDP_GetLeftBorder(vCM);vT=vT-10-(vLB*2);}for(var vI=0;vI<vHrs.length;vI++)vHrs[vI].style.width=vT+"px";}}pFld.Inited=true;}function PM_TestContext(pE){if(!pE&&gPDP_IEWin&&window.event.returnValue==false)return false;if(!gPDP_IEWin&&gPDPMenuOpen&&window.event)window.event.returnValue=false;return!gPDPMenuOpen;}