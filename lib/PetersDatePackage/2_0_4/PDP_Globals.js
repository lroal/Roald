// Copyright 2002 - 2007 Peter L. Blum, All Rights Reserved, www.PeterBlum.com
// Peter's Date Package Release 2.0.4

var gPDP_UAgent=navigator.userAgent.toLowerCase();var gPDP_OS,gPDP_Browser,gPDP_BrowserVers;var gPDP_Opera=false;var gPDP_Opera7=false;var gPDP_Opera9=false;var gPDP_IEWin=false;var gPDP_IEWin55=false;var gPDP_IEWin7=false;var gPDP_IEMac=false;var gPDP_IEMac51=false;var gPDP_IEMacOSX=false;var gPDP_NetscapeNav=false;var gPDP_Gecko=false;var gPDP_Konqueror=false;var gPDP_FireFox=false;var gPDP_FireFox15=false;var gPDP_Safari=false;var gPDP_SupportsInnerHTML=(document.body!=null)&&(document.body.innerHTML!=null);var gPDP_SupportsOnKeyPress=true;var gPDP_SupportsFocusOnTable=false;if(PDP_ChkBrws('konqueror')){gPDP_Browser="Konqueror";gPDP_OS="Linux";gPDP_Konqueror=true;}else if(PDP_ChkBrws('safari',1)||PDP_ChkBrws('applewebkit',1)){gPDP_Browser="Safari";gPDP_Safari=true;}else if(PDP_ChkBrws('omniweb',1))gPDP_Browser="OmniWeb";else if(PDP_ChkBrws('opera',1)){gPDP_Browser="Opera";gPDP_Opera=true;}else if(PDP_ChkBrws('webtv',1))gPDP_Browser="WebTV";else if(PDP_ChkBrws('msie',1)){gPDP_Browser="Internet Explorer";gPDP_IEWin=true;}else if(PDP_ChkBrws('netscape',1)){gPDP_Browser="Netscape Mozilla";gPDP_Gecko=true;}else if(PDP_ChkBrws('gecko',1)){gPDP_Browser="Gecko";gPDP_Gecko=true;}else if(!PDP_ChkBrws('compatible',1)){gPDP_Browser="Netscape Navigator";gPDP_BrowserVers=gPDP_UAgent.charAt(8);gPDP_NetscapeNav=true;}else gPDP_Browser="An unknown browser";if(!gPDP_OS){if(PDP_ChkBrws('linux',0))gPDP_OS="Linux";else if(PDP_ChkBrws('x11',0))gPDP_OS="Unix";else if(PDP_ChkBrws('mac',0))gPDP_OS="Mac";else if(PDP_ChkBrws('win',0))gPDP_OS="Windows";else gPDP_OS="an unknown operating system";}if(gPDP_IEWin&&(gPDP_OS=="Mac")){gPDP_IEWin=false;gPDP_IEMac=true;if((gPDP_UAgent.indexOf("msie 5.1b")>-1)||(gPDP_UAgent.indexOf("msie 5.2")>-1))gPDP_IEMacOSX=true;else if(gPDP_UAgent.indexOf("msie 5.1")>-1)gPDP_IEMac51=true;}else if(gPDP_IEWin){if((gPDP_UAgent.indexOf("msie 5.5")>-1)||(gPDP_UAgent.indexOf("msie 6")>-1))gPDP_IEWin55=true;else if(gPDP_UAgent.indexOf("msie 7")>-1){gPDP_IEWin55=true;gPDP_IEWin7=true;}}else if(gPDP_Opera){var vV=parseInt(gPDP_BrowserVers);if(vV>=7){gPDP_Opera7=true;gPDP_Opera=false;if(vV>=9)gPDP_Opera9=true;}}else if(gPDP_Gecko){if(PDP_ChkBrws('firefox',1)){gPDP_FireFox=true;gPDP_Browser="FireFox";if(parseFloat(gPDP_BrowserVers)>=1.5)gPDP_FireFox15=true;}}gPDP_SupportsOnKeyPress=!gPDP_Opera&&!gPDP_Konqueror;gPDP_SupportsFocusOnTable=gPDP_IEWin;function PDP_ChkBrws(pID,pSetVer){var vPos=gPDP_UAgent.indexOf(pID)+1;if(pSetVer&&vPos){gPDP_BrowserVers=parseFloat(gPDP_UAgent.substring(vPos+pID.length));if(isNaN(gPDP_BrowserVers))gPDP_BrowserVers=gPDP_UAgent.charAt(vPos+pID.length);}return vPos;}var gPDP_FormName="";var gPDP_NS4RegEx=new RegExp(":","g");function PDP_InitObject(pID,pProp,pObj,pICB,pIO){if(pICB&&(window.gPDPDebugAJAX==true)){window.setTimeout("alert('EmbedScripts in callback');window.gPDPDebugAJAX = true;",1000);window.gPDPDebugAJAX=false;}if(pICB)window.gPDP_InCB=true;var vL=window.gPDP_Objects;if(pICB&&pObj.Dispose&&vL)for(var vI=0;vI<vL.length;vI++){var vOld=vL[vI];if(vOld.OwnerID==pID){vL[vI]=null;vOld.Dispose(vOld);}}var vF=PDP_GetById(pID);if(vF){if(!pICB&&(pProp=="AO")&&pObj.IsPopup){PDP_RelocatePopup(vF);vF=PDP_GetById(pID);}if(!pIO){eval("vF."+pProp+"=pObj;");pObj.OwnerID=pID;if((pProp=="PO")&&(pObj.OwnID)){var vOFld=PDP_GetById(pObj.OwnID);if(vOFld)vOFld.onfocus=new Function("PDP_HideFocus('"+vOFld.id+"', true);");}}}if(pObj.Init)pObj.Init(pID,pObj,pICB);if(pObj.Dispose){if(!vL){vL=window.gPDP_Objects=new Array;PDP_AttachEvent(document.body,"onunload","PDP_DisposeObjects",false);}vL[vL.length]=pObj;}window.gPDP_InCB=false;}function PDP_DisposeObjects(){var vL=window.gPDP_Objects;if(vL)for(var vI=0;vI<vL.length;vI++){var vObj=vL[vI];if(vObj.Dispose)vObj.Dispose(vObj);vL[vI]=null;}window.gPDP_Objects=null;}var gPDP_ObjInited=false;function PDP_StartInit(pID,pProp,pObj,pICB,pIO){if(pICB&&(window.gPDPDebugAJAX==true)){alert("Start Init in callback. Must see another alert with Finish Init.");window.gPDPDebugAJAX=false;window.gPDPDebugAJAX2=true;}var vL=window.gPDP_QueuedInits;if(!vL)vL=window.gPDP_QueuedInits=new Array();vL[vL.length]={ID:pID,Prop:pProp,Obj:pObj,ICB:pICB,IO:pIO};}function PDP_FinishInit(){var vL=window.gPDP_QueuedInits;if(vL){for(var vI=0;vI<vL.length;vI++){var vO=vL[vI];PDP_InitObject(vO.ID,vO.Prop,vO.Obj,vO.ICB,vO.IO);}if(window.gPDPDebugAJAX2){alert("Finish Init in callback");window.gPDPDebugAJAX=true;window.gPDPDebugAJAX2=null;}}window.gPDP_QueuedInits=null;}function PDP_InitObjects(pForce){if(window.SD_InitObjects)SD_InitObjects();if(window.DES_SDInitAll)DES_SDInitAll();PDP_FinishInit();}function PDP_SetInnerHTML(pFld,pValue){if(gPDP_IEMac51||gPDP_IEMacOSX){pFld.innerHTML="";var vNewEl=document.createElement("span");vNewEl.innerHTML=pValue;pFld.appendChild(vNewEl);}else pFld.innerHTML=pValue;}function PDPUtil_GetChildNodes(pParent,pNodeName,pIndex){var vFoundCount=0;var vChildren=null;if(pParent.childNodes){vChildren=pParent.childNodes;}else if(pParent.children){vChildren=pParent.children;}else if(pParent.getElementsByTagName){vChildren=pParent.getElementsByTagName(pNodeName);}else{return null;}var vLength=vChildren.length;for(var vCount=0;vCount<vLength;vCount++)if(vChildren[vCount].nodeName==pNodeName){vFoundCount++;if(vFoundCount==pIndex)return vChildren[vCount];}return null;}function PDP_GetById(pId){if(document.getElementById)return document.getElementById(pId);else if(document.all)return document.all[pId];else if(document.layers){var vElement="";eval("vElement=document."+gPDP_FormName+"['"+pId+"']");return vElement;}else return null;}function PDP_AttachEvent(pFld,pEvtName,pCode,pFst){if(typeof(pFld)=="string")pFld=PDP_GetById(pFld);var vEv=eval("pFld."+pEvtName+";");if(typeof(vEv)=="function"){vEv=vEv.toString();vEv=vEv.substring(vEv.indexOf("{")+1,vEv.lastIndexOf("}"));if(vEv.charAt(vEv.length-1)!=";")vEv=vEv+";";}else vEv="";if(pFst)vEv=pCode+vEv;else vEv=vEv+pCode;eval("pFld."+pEvtName+"= function("+(window.attachEvent==null?"event){":"){")+vEv+"}");}function PDP_ParentNode(pElement){if(pElement.parentElement!=null)return pElement.parentElement;else if(pElement.parentNode!=null)return pElement.parentNode;else return null;}function PDP_CanEdit(pFId){var vFld=PDP_GetById(pFId);return!(vFld.disabled||vFld.readOnly);}function PDP_CmdCanEdit(pFId){var vFld=PDP_GetById(pFId);return!(vFld.disabled||(vFld.readOnly&&!vFld.AO.ROED));}function PDP_HideFocus(pControlID,pValue){var vField=PDP_GetById(pControlID);if(vField.hideFocus!=null)vField.hideFocus=pValue;}function PDP_GetAtt(pElement,pAttributeName,pDefaultValue){if(gPDP_Safari)pAttributeName=pAttributeName.replace("_","");if(gPDP_Opera7){var vResult=eval("pElement."+pAttributeName);if(vResult==null)vResult=pElement.getAttribute(pAttributeName,0);if((vResult==null)||(vResult==""))vResult=pDefaultValue;return vResult;}else if(pElement.getAttribute){var vResult=pElement.getAttribute(pAttributeName,0);if(!gPDP_IEWin&&(vResult==null))vResult=eval("pElement."+pAttributeName);if(vResult==null)vResult=pDefaultValue;else if((vResult=="")&&(!document.all))vResult=pDefaultValue;return vResult;}else{var vId=pElement.name.replace(gPDP_NS4RegEx,"_");var vVarName=vId+"_"+pAttributeName;var vResult=eval(vVarName);if((vResult==null)||(vResult==""))vResult=pDefaultValue;return vResult;}}function PDP_SetAtt(pElement,pAttributeName,pAttributeValue){if(gPDP_Opera7){eval("pElement."+pAttributeName+"=pAttributeValue");}else if(pElement.setAttribute)pElement.setAttribute(pAttributeName,pAttributeValue,0);else{var vVarName=pElement.name+"_"+pAttributeName;eval("vVarName = pAttributeValue.toString();");}}function PDP_CanEditParent(pFId){var vPos=pFId.lastIndexOf("_");if(vPos>-1){var vEFldId=pFId.substr(0,vPos);var vEFld=PDP_GetById(vEFldId);if((vEFld!=null)&&(((vEFld.readonly!=null)&&(vEFld.readonly))||((vEFld.disabled!=null)&&(vEFld.disabled))))return false;}return true;}function PDP_SetBkColor(pElement,pColor){if(gPDP_Opera){if(pColor=="")pColor="white";pElement.style.background=pColor;}else pElement.style.backgroundColor=pColor;}function PDP_OnMouseEvent(pFld,pFC,pBrdC){if((pFC=='')&&pFld.OldFC)pFC=pFld.OldFC;else if(pFld.OldFC==null)pFld.OldFC=pFld.style.color;if((pBrdC=='')&&pFld.OldBrdC)pBrdC=pFld.OldBrdC;else if(pFld.OldBrdC==null)pFld.OldBrdC=pFld.style.borderLeftColor;pFld.style.borderLeftColor=pBrdC;pFld.style.borderRightColor=pBrdC;pFld.style.borderTopColor=pBrdC;pFld.style.borderBottomColor=pBrdC;pFld.style.color=pFC;}function PDP_FireEvent(pFld,pEN,pDOMET){if(typeof(pFld)=="string")pFld=PDP_GetById(pFld);if(pFld.fireEvent!=null)pFld.fireEvent('on'+pEN);else if((document.createEvent!=null)&&!gPDP_Opera7&&!gPDP_Safari){var vEv=document.createEvent(pDOMET);if(gPDP_Safari)pDOMET="HTMLEvents";switch(pDOMET){case"UIEvents":vEv.initUIEvent(pEN,true,true,window,0);break;case"MouseEvents":vEv.initMouseEvent(pEN,true,true,window,0,0,0,0,0,false,false,false,false,0,null);break;default:vEv.initEvent(pEN,true,false);break;}pFld.dispatchEvent(vEv);}else{var vEv="";if(gPDP_Opera7)vEv=eval("pFld.on"+pEN);else vEv=pFld.getAttribute('on'+pEN);vEv=vEv.toString();if(vEv.indexOf("javascript:")==0)vEv=vEv.slice(11);if(vEv.indexOf("function")>-1)vEv=vEv.substring(vEv.indexOf("{")+1,vEv.lastIndexOf("}"));eval(vEv+';');}}function PDP_GetKeyCode(pE){var vKeyCode=null;if(pE.keyCode)vKeyCode=pE.keyCode;else if(pE.which)vKeyCode=pE.which;return vKeyCode;}function PDP_IsShift(pE){var vShiftKey=false;if(pE.shiftKey!=null)vShiftKey=pE.shiftKey;else if(pE.modifiers!=null)vShiftKey=(pE.modifiers|4)!=0;return vShiftKey;}function PDP_IsCtrl(pE){var vCtrlKey=false;if(pE.ctrlKey!=null)vCtrlKey=pE.ctrlKey;else if(pE.modifiers!=null)vCtrlKey=(pE.modifiers|2)!=0;return vCtrlKey;}function PDP_StopEvent(pE){if(pE.cancelBubble!=null)pE.cancelBubble=true;if(pE.stopPropagation)pE.stopPropagation();if(pE.preventDefault)pE.preventDefault();}function PDP_Trunc(pDecimal){var vStr=pDecimal.toString();var vPos=vStr.indexOf(".");if(vPos==-1)return parseInt(vStr);else return parseInt(vStr.substr(0,vPos));}function PDP_FmtDate(pYear,pMonth,pDay,pPattern,pFormat){if(pDay==0)return"";var vResult="";vResult=pPattern.replace("yyyy",pYear.toString());if(vResult.indexOf("yy")!=-1){var vShortYear=pYear%100;if(vShortYear>9)vResult=vResult.replace("yy",vShortYear.toString());else vResult=vResult.replace("yy","0"+vShortYear.toString());}if(vResult.indexOf("dd")!=-1){if(pDay>9)vResult=vResult.replace("dd",pDay.toString());else vResult=vResult.replace("dd","0"+pDay.toString());}else vResult=vResult.replace("d",pDay.toString());if(pFormat==0){var vAdjMonth=pMonth+1;if(vResult.indexOf("MM")!=-1){if(vAdjMonth>9)vResult=vResult.replace("MM",vAdjMonth.toString());else vResult=vResult.replace("MM","0"+vAdjMonth.toString());}else vResult=vResult.replace("M",vAdjMonth.toString());}else if(pFormat==1){var vDate=new Date(pYear,pMonth,pDay);var vDayOfWeek=vDate.getDay();if(window.PDP_AbbrevMonths)vResult=vResult.replace("MMMM",PDP_AbbrevMonths[pMonth]);if(window.PDP_AbbrevDaysOfWeek)vResult=vResult.replace("ww",PDP_AbbrevDaysOfWeek[vDayOfWeek]);}else{var vDate=new Date(pYear,pMonth,pDay);var vDayOfWeek=vDate.getDay();if(window.PDP_Months)vResult=vResult.replace("MMMM",PDP_Months[pMonth]);if(window.PDP_DaysOfWeek)vResult=vResult.replace("ww",PDP_DaysOfWeek[vDayOfWeek]);}return vResult;}function PDP_FmtDate2(pDate,pPattern,pFormat){if(pDate){return PDP_FmtDate(pDate.getUTCFullYear(),pDate.getUTCMonth(),pDate.getUTCDate(),pPattern,pFormat);}else return"";}function PDP_GetCmdId(pCmdKeys,pKeyCode,pCtrlKey,pShiftKey,pIsOnKeyDown){var vCommandId="0";var vModifiers=pCtrlKey?"C":"";var vMod2=pShiftKey?"S":"";vModifiers=vModifiers+vMod2;var vFirstToken="{#"+pKeyCode+vModifiers;var vPos=pCmdKeys.indexOf(vFirstToken);if(vPos>-1){var vEndPos=pCmdKeys.indexOf("}",vPos+vFirstToken.length+1);if(vEndPos>-1)vCommandId=pCmdKeys.substring(vPos+vFirstToken.length+1,vEndPos);}else if(!pIsOnKeyDown){var vKeyCodeStr=String.fromCharCode(pKeyCode);vKeyCodeStr=vKeyCodeStr.toUpperCase();vFirstToken="{"+vKeyCodeStr+vModifiers;vPos=pCmdKeys.indexOf(vFirstToken);if(vPos>-1){var vEndPos=pCmdKeys.indexOf("}",vPos+vFirstToken.length+1);if(vEndPos>-1)vCommandId=pCmdKeys.substring(vPos+vFirstToken.length+1,vEndPos);}}return vCommandId;}function PDP_ButtonEffect(pFldWStyle,pNewStyle,pFieldID_WithImage,pImageUrl){if(!PDP_CanEditParent(pFldWStyle.id))return;if(pFldWStyle&&pFldWStyle.className)pFldWStyle.className=pNewStyle;if((pImageUrl!="")&&(pFieldID_WithImage!="")){vFieldWithImage=PDP_GetById(pFieldID_WithImage);if(vFieldWithImage&&vFieldWithImage.src)vFieldWithImage.src=pImageUrl;}}function PDP_CtlInited(pFld){if(!pFld.AO){alert('Page is loading. Please wait.');return false;}return true;}function PDP_UnselectPage(){if(gPDP_IEWin55&&document.execCommand)document.execCommand("Unselect",false,null);}var gPopupCId=new Array("","","","","");var gToggleCId=new Array("","","","","");var gPUNPos=-1;function PDP_TogglePopup(pTglCId,pPUCId,pOnPopup){var vPUC=PDP_GetById(pPUCId);if(vPUC.style.visibility=="inherit"){PDP_ClosePopup();}else{PDP_OpenPopup(pTglCId,pPUCId,true,pOnPopup);}}var gPDP_InOP=false;function PDP_OpenPopup(pTglCId,pPUCId,pClick,pOnPopup){var vTglC=null;if(pTglCId!="")vTglC=PDP_GetById(pTglCId);if(vTglC!=null)if(vTglC.disabled)return;if(pClick&&window.event)PDP_TestCaptureNS6(window.event);if(gPUNPos>=gPopupCId.length)return;if(gPDP_InOP)return;gPDP_InOP=true;var vPUC=PDP_GetById(pPUCId);if(vPUC.PO.PUS&&window.PDP_AddShadow)PDP_AddShadow(vPUC);var vFlt=(vPUC.PO.PUT&&window.PDP_PopupTransform)?PDP_PopupTransform(vPUC,1):null;var vOPUFnc="";if(pOnPopup!=null)vOPUFnc=pOnPopup;else if(vPUC.PO)vOPUFnc=vPUC.PO.onpopup;if((vOPUFnc!=null)&&(vOPUFnc!="")){var vResult=true;eval(vOPUFnc);if(vResult==false){gPDP_InOP=false;if(vFlt)vFlt.play();return;}}gPUNPos++;gPopupCId[gPUNPos]=pPUCId;gToggleCId[gPUNPos]=pTglCId;if(vTglC!=null)PDP_PositionPopupToToggle(vTglC,vPUC);PDP_MSIEFixPopupOpen(vPUC);vPUC.style.visibility="inherit";vPUC.Poppedup=true;if(vPUC.focus&&!vPUC.NoFocus)setTimeout("javascript:var vPUC2 = PDP_GetById('"+pPUCId+"'); if (vPUC2.Poppedup && (vPUC2.style.visibility = 'inherit')) vPUC2.focus();",50);if(document.attachEvent){if(gPUNPos==0)document.attachEvent("onmousedown",PDP_TestCaptureIE5);}else if(document.addEventListener){if(gPUNPos==0)document.addEventListener("mousedown",PDP_TestCaptureNS6,false);}else document.onmousedown=PDP_TestCaptureIE5;if(vFlt)vFlt.play();gPDP_InOP=false;}function PDP_OpenPopupAtMousePoint(pPUCId,pE){if((document.body.scrollTop==null)&&(window.pageXOffset))return;PDP_TestCaptureNS6(pE);if(gPUNPos>=gPopupCId.length)return;var vPUC=PDP_GetById(pPUCId);vPUC.style.position="absolute";var vClientX=PDP_GetScrolledX(vPUC,pE.clientX,true);var vClientY=PDP_GetScrolledY(vPUC,pE.clientY,true);if(true){vClientX=PDP_GetOffsetX(vPUC,vClientX,-1);vClientY=PDP_GetOffsetY(vPUC,vClientY,-1);}if(gPDP_IEMac){vClientX=vClientX+10;vClientY=vClientY+15;}if(gPDP_Safari){vClientX=vClientX+document.body.offsetLeft;vClientY=vClientY+document.body.offsetTop;}PDP_SetLeftPos(vPUC,vClientX);PDP_SetTopPos(vPUC,vClientY);vPUC.style.zIndex=30000+gPUNPos+1;if((gPUNPos==-1)||(gPopupCId[gPUNPos]!=pPUCId))PDP_OpenPopup("",pPUCId,true);}function PDP_GetScrolledX(pPUC,pX,pLimit){if(document.body.scrollLeft!=null){var vDE=document.documentElement;if(pLimit){var vOW=(vDE&&vDE.offsetWidth)?vDE.offsetWidth:document.body.offsetWidth;if(pX+pPUC.offsetWidth>vOW)pX=pX-pPUC.offsetWidth;if(pX<0)pX=0;}for(var vPar=PDP_ParentNode(pPUC);(vPar!=document.body)&&(vPar!=null);vPar=PDP_ParentNode(vPar)){if(vPar.scrollLeft!=null)pX=pX+vPar.scrollLeft;}if(vDE&&vDE.scrollLeft)pX=pX+vDE.scrollLeft;else pX=pX+document.body.scrollLeft;}else if(window.pageXOffset!=null){pX=pX+window.pageXOffset;}return pX;}function PDP_GetScrolledY(pPUC,pY,pLimit){if(document.body.scrollTop!=null){var vDE=document.documentElement;if(pLimit){var vOH=(vDE&&vDE.offsetHeight)?vDE.offsetHeight:document.body.offsetHeight;if(pY+pPUC.offsetHeight>vOH)pY=pY-pPUC.offsetHeight;if(pY<0)pY=0;}for(var vPar=PDP_ParentNode(pPUC);(vPar!=document.body)&&(vPar!=null);vPar=PDP_ParentNode(vPar)){if(vPar.scrollTop!=null)pY=pY+vPar.scrollTop;}if(vDE&&vDE.scrollTop)pY=pY+vDE.scrollTop;else pY=pY+document.body.scrollTop;}else if(window.pageXOffset!=null){pY=pY+window.pageYOffset;}return pY;}function PDP_GetOffsetX(pControl,pIPos,pDir,pTstBrd){var vLeftPos=pIPos;if(pTstBrd)vLeftPos=vLeftPos+pDir*PDP_GetLeftBorder(pControl);if(pControl.offsetParent)for(var vPar=pControl.offsetParent;(vPar!=null);vPar=vPar.offsetParent){if(!gPDP_Opera7||(vPar.style.display!="inline-block"))vLeftPos=vLeftPos+pDir*vPar.offsetLeft;if(!gPDP_Safari||(vPar!=document.body))vLeftPos=vLeftPos+pDir*PDP_GetLeftBorder(vPar);if(gPDP_Safari&&(vPar.style.position=="absolute"))break;}else for(var vPar=pControl.parentNode;(vPar!=document.body)&&(vPar!=null);vPar=vPar.parentNode){if(vPar.style.position=="absolute"){vLeftPos=vLeftPos+pDir*vPar.offsetLeft;break;}}return vLeftPos;}function PDP_GetOffsetY(pControl,pIPos,pDir,pTstBrd){var vTopPos=pIPos;if(pTstBrd)vTopPos=vTopPos+pDir*PDP_GetTopBorder(pControl);if(pControl.offsetParent)for(var vPar=pControl.offsetParent;(vPar!=null);vPar=vPar.offsetParent){if(!gPDP_Opera7||(vPar.style.display!="inline-block"))vTopPos=vTopPos+pDir*vPar.offsetTop;if(!gPDP_Safari||(vPar!=document.body))vTopPos=vTopPos+pDir*PDP_GetTopBorder(vPar);if(gPDP_Safari&&(vPar.style.position=="absolute"))break;}else for(var vPar=pControl.parentNode;(vPar!=document.body)&&(vPar!=null);vPar=vPar.parentNode){if(vPar.style.position=="absolute"){vTopPos=vTopPos+pDir*vPar.offsetTop;break;}}return vTopPos;}function PDP_ConvBorderWidth(pW,pS){if(pS=="none")return 0;switch(pW){case'thin':return 2;case'medium':return 4;case'thick':return 6;default:var vR=parseInt(pW);if(isNaN(vR))return 0;return vR;}}function PDP_GetLeftBorder(pC){if(pC.currentStyle){var vBrd=PDP_ConvBorderWidth(pC.currentStyle.borderLeftWidth,pC.currentStyle.borderLeftStyle);return isNaN(vBrd)?0:vBrd;}else if(window.getComputedStyle){var vBrd=parseInt(document.defaultView.getComputedStyle(pC,null).getPropertyValue("border-left-width"));return isNaN(vBrd)?0:vBrd;}else if(gPDP_Safari||gPDP_Opera7){var vBrd=(pC.offsetWidth-pC.clientWidth)/2;return isNaN(vBrd)?0:vBrd;}return 0;}function PDP_GetTopBorder(pC){if(pC.currentStyle){var vBrd=PDP_ConvBorderWidth(pC.currentStyle.borderTopWidth,pC.currentStyle.borderTopStyle);return isNaN(vBrd)?0:vBrd;}else if(window.getComputedStyle){var vBrd=parseInt(document.defaultView.getComputedStyle(pC,null).getPropertyValue("border-top-width"));return isNaN(vBrd)?0:vBrd;}else if(gPDP_Safari){var vBrd=(pC.offsetHeight-pC.clientHeight)/2;return isNaN(vBrd)?0:vBrd;}return 0;}function PDP_AbsParent(pPUC){if(pPUC.offsetParent)for(var vPar=pPUC.offsetParent;(vPar!=document.body)&&(vPar!=null);vPar=vPar.offsetParent){if(vPar.style.position=="absolute"){return true;}}else for(var vPar=pPUC.parentNode;(vPar!=document.body)&&(vPar!=null);vPar=vPar.parentNode){if(vPar.style.position=="absolute"){return true;}}return false;}function PDP_ClosePopup(){if(gPUNPos==-1)return;if(gPDP_InOP)return;gPDP_InOP=true;var vPUC=PDP_GetById(gPopupCId[gPUNPos]);var vFlt=(vPUC.PO.PUT&&window.PDP_PopupTransform)?PDP_PopupTransform(vPUC,0):null;if(vPUC.PO&&vPUC.PO.onpopdown)eval(vPUC.PO.onpopdown);vPUC.style.visibility="hidden";vPUC.Poppedup=false;if(document.detachEvent){if(gPUNPos==0)document.detachEvent("onmousedown",PDP_TestCaptureIE5);}else if(document.removeEventListener){if(gPUNPos==0)document.removeEventListener("mousedown",PDP_TestCaptureNS6,false);}PDP_MSIEFixPopupClose(vPUC);gPopupCId[gPUNPos]="";gToggleCId[gPUNPos]="";gPUNPos--;if(vFlt)vFlt.play();if(gPUNPos>-1){var vLwrPC=PDP_GetById(gPopupCId[gPUNPos]);if((vLwrPC.style.visibility!="hidden")&&(vLwrPC.focus!=null))vLwrPC.focus();}gPDP_InOP=false;}function PDP_CloseAllPopups(){while(gPUNPos>-1)PDP_ClosePopup();}function PDP_DelayedClosePopup(){window.setTimeout("PDP_ClosePopup();",100);}function PDP_PositionPopupToToggle(pTglC,pPUC){var vHorizPos="leftsidesalign";var vVertPos="popupbelow";var vHorzOffset=0;var vVertOffset=0;var vPO=pPUC.PO;if(vPO!=null){vHorizPos=vPO.HPos;vVertPos=vPO.VPos;vHorzOffset=vPO.HPosOf;vVertOffset=vPO.VPosOf;}var vLeftPos=pTglC.offsetLeft;var vTopPos=pTglC.offsetTop;vLeftPos=PDP_GetOffsetX(pTglC,pTglC.offsetLeft,1);vTopPos=PDP_GetOffsetY(pTglC,pTglC.offsetTop,1);if(gPDP_IEMac){vLeftPos=vLeftPos+10;vTopPos=vTopPos+15;}if(gPDP_Safari){vLeftPos=vLeftPos+document.body.offsetLeft;vTopPos=vTopPos+document.body.offsetTop;}var vToggleWidth=pTglC.offsetWidth;var vPopupWidth=pPUC.offsetWidth;if(pPUC.clientWidth&&(pPUC.clientWidth<pPUC.offsetWidth)){vHorzOffset+=(pPUC.offsetWidth-pPUC.clientWidth)/2;}switch(vHorizPos){case"leftsidesalign":vLeftPos=vLeftPos;break;case"center":vLeftPos=vLeftPos+(vToggleWidth-vPopupWidth)/2;break;case"rightsidesalign":vLeftPos=vLeftPos+vToggleWidth-vPopupWidth;break;case"popuptoright":vLeftPos=vLeftPos+vToggleWidth;break;}vLeftPos=vLeftPos+vHorzOffset;var vToggleHeight=pTglC.offsetHeight;var vPopupHeight=pPUC.offsetHeight;if(pPUC.clientHeight&&(pPUC.clientHeight<pPUC.offsetHeight)){vVertOffset+=(pPUC.offsetHeight-pPUC.clientHeight)/2;}switch(vVertPos){case"popupbelow":vTopPos=vTopPos+vToggleHeight;break;case"center":vTopPos=vTopPos+(vToggleHeight-vPopupHeight)/2;break;case"popupabove":vTopPos=vTopPos-vPopupHeight;break;case"topsidesalign":vTopPos=vTopPos;break;}vTopPos=vTopPos+vVertOffset;vLeftPos=PDP_GetOffsetX(pPUC,vLeftPos,-1,true);vTopPos=PDP_GetOffsetY(pPUC,vTopPos,-1,true);var vSX=0;var vSY=0;if(!gPDP_Opera7){var vSX=PDP_GetScrolledX(pTglC,0,false);var vSY=PDP_GetScrolledY(pTglC,0,false);vLeftPos=vLeftPos+PDP_GetScrolledX(pPUC,0,false)-vSX;vTopPos=vTopPos+PDP_GetScrolledY(pPUC,0,false)-vSY;}var vDE=document.documentElement;var vDB=document.body;if(!vDE)vDE=vDB;if(gPDP_IEWin55||(gPDP_Gecko&&!gPDP_FireFox15))if(vDE&&(vDE.offsetWidth!=null)){var vLP=vLeftPos+pPUC.offsetWidth;var vLDE=(vDE.scrollLeft?vDE.scrollLeft:vDB.scrollLeft)+vDE.offsetWidth+vSX;if(vLP>vLDE)vLeftPos=vLeftPos-(vLP-vLDE);var vTP=vTopPos+pPUC.offsetHeight;var vTDE=(vDE.scrollTop?vDE.scrollTop:vDB.scrollTop)+vDE.offsetHeight+vSY;if(vTP>vTDE)vTopPos=vTopPos-(vTP-vTDE);}if((window.__smartNav==null)||(!PDP_AbsParent(pPUC))){if(vLeftPos<0)vLeftPos=0;if(vTopPos<0)vTopPos=0;}pPUC.style.position="absolute";PDP_SetLeftPos(pPUC,vLeftPos);PDP_SetTopPos(pPUC,vTopPos);pPUC.style.zIndex=30000+gPUNPos;if(gPDP_IEMac){if(pPUC.style.pixelWidth=="")pPUC.style.pixelWidth=pPUC.offsetWidth;if(pPUC.style.pixelHeight=="")pPUC.style.pixelHeight=pPUC.offsetHeight;}}function PDP_TestCaptureIE5(){PDP_TestCaptureNS6(window.event);}function PDP_TestCaptureNS6(e){if(gPUNPos==-1)return;if(gPDP_InOP)return;var vEndCaptureB=false;var vPUC=PDP_GetById(gPopupCId[gPUNPos]);var vX=gPDP_Safari?e.clientX:PDP_GetScrolledX(vPUC,e.clientX,false);var vY=gPDP_Safari?e.clientY:PDP_GetScrolledY(vPUC,e.clientY,false);if(gPDP_IEMac&&!gPDP_IEMacOSX){vX=vX-10;vY=vY-15;}if(gPDP_Safari){vX=vX+document.body.offsetLeft;vY=vY+document.body.offsetTop;}var vLeftPos=vPUC.offsetLeft;var vTopPos=vPUC.offsetTop;vLeftPos=PDP_GetOffsetX(vPUC,vPUC.offsetLeft,1);vTopPos=PDP_GetOffsetY(vPUC,vPUC.offsetTop,1);if(gPDP_Opera7){vLeftPos=vLeftPos-PDP_GetLeftBorder(document.body);vTopPos=vTopPos-PDP_GetTopBorder(document.body);}if(vX<vLeftPos){vEndCaptureB=true;}else if(vX>vLeftPos+vPUC.offsetWidth){vEndCaptureB=true;}else if(vY<vTopPos){vEndCaptureB=true;}else if(vY>vTopPos+vPUC.offsetHeight){vEndCaptureB=true;}if(vEndCaptureB&&(gToggleCId[gPUNPos]!="")){var vTglC=PDP_GetById(gToggleCId[gPUNPos]);var vTL=vTglC.offsetLeft-PDP_GetLeftBorder(vTglC);var vTT=vTglC.offsetTop-PDP_GetTopBorder(vTglC);if((vX>=vTL)&&(vX<=vTL+vTglC.offsetWidth)&&(vY>=vTT)&&(vY<=vTT+vTglC.offsetHeight))vEndCaptureB=false;}if(vEndCaptureB){PDP_ClosePopup();if(gPUNPos>-1)PDP_TestCaptureNS6(e);}}function PDP_MSIEFixPopupOpen(pFld){if(gPDP_IEWin55&&pFld.PO.IEFix){var vIFrNm="PDP_ZIndexFix_"+pFld.id;if(!document.all[vIFrNm]){var vIFrame="<iframe src='javascript:false;' id='"+vIFrNm+"' scrolling='no' frameborder='0'  "+"style='position:absolute;top:0x;left:0px;"+"display:none'></iframe>";var vElement=pFld.parentElement;vElement.insertAdjacentHTML('beforeEnd',vIFrame);}if(document.all[vIFrNm]){var vStyle=document.all[vIFrNm].style;vStyle.pixelTop=pFld.style.pixelTop;vStyle.pixelLeft=pFld.style.pixelLeft;vStyle.pixelWidth=pFld.offsetWidth+6;vStyle.pixelHeight=pFld.offsetHeight+6;var vZIndex=29990-gPUNPos;vStyle.zIndex=vZIndex;vStyle.filter='progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)';vStyle.display='block';}}}function PDP_MSIEFixPopupClose(pFld){if(gPDP_IEWin55&&pFld.PO.IEFix){var vIFrNm="PDP_ZIndexFix_"+pFld.id;if(document.all[vIFrNm]){document.all[vIFrNm].style.display='none';}}}function PDP_SetLeftPos(pFld,pLeftPos){if(pFld.style.pixelLeft)pFld.style.pixelLeft=pLeftPos;else if(pFld.style.posLeft)pFld.style.posLeft=pLeftPos.toString()+"px";else pFld.style.left=pLeftPos.toString()+"px";}function PDP_SetTopPos(pFld,pTopPos){if(pFld.style.pixelTop)pFld.style.pixelTop=pTopPos;else if(pFld.style.posTop)pFld.style.posTop=pTopPos.toString()+"px";else pFld.style.top=pTopPos.toString()+"px";}var gPDP_ProcessingError=false;function PDP_ShowError(pFldId,pErrorCode,pShowAlert){if(!gPDP_ProcessingError){var vCode="javascript:PDP_ShowErrorBody('"+pFldId+"', "+pErrorCode+","+pShowAlert+")";setTimeout(vCode,10);}}function PDP_ShowErrorBody(pFldId,pErrorCode,pShowAlert){if(gPDP_ProcessingError)return;gPDP_ProcessingError=true;var vFld=PDP_GetById(pFldId);var vAO=vFld.AO;if(vFld.style){if(vAO.ErrFC!='')vFld.style.color=vAO.ErrFC;if(vAO.ErrBC!='')PDP_SetBkColor(vFld,vAO.ErrBC);}else pShowAlert=true;if(!gPDP_SupportsOnKeyPress)pShowAlert=true;if(vFld.focus&&vFld.select){if(vAO.FOErr){vFld.focus();vFld.select();}}if(pShowAlert){var vEM="";switch(pErrorCode){case 1:vEM=vAO.InvalidMsg;break;case 2:vEM=vAO.OutOfRangeMsg;break;case 3:var vSAO=PDP_GetById(vAO.RngSId).AO;vEM=vSAO.RngMMsg;}if(vEM!='')try{alert(vEM);}catch(e){}}gPDP_ProcessingError=false;}function PDP_ClearError(pFldId){var vTBFld=PDP_GetById(pFldId);if(vTBFld.style){vTBFld.style.color=vTBFld.AO.OrigFC;PDP_SetBkColor(vTBFld,vTBFld.AO.OrigBC);}}function PDP_ParseInt(pValue){if((pValue=='0')||(pValue=='00'))return 0;else return parseInt(pValue.replace(/^0*/,''));}function PDP_MakeUTCDate(pYear,pMonth,pDay){if((pYear==null)||(pMonth==null)||(pDay==null))return null;var vDate=new Date(0);vDate.setUTCFullYear(pYear,pMonth,pDay);vDate.setUTCHours(0,0,0,0);return vDate;}function PDP_AddMonths(pDate,pNumMonths){var vMonth=pDate.getMonth();var vYear=pDate.getFullYear();var vDay=pDate.getDate();if(pNumMonths>0){vMonth=vMonth+pNumMonths;var vIncYears=Math.round((vMonth/12)-0.5);vYear=vYear+vIncYears;vMonth=vMonth%12;}else{vMonth=11-vMonth;vMonth=vMonth-pNumMonths;var vIncYears=Math.round((vMonth/12)-0.5);vYear=vYear-vIncYears;vMonth=11-(vMonth%12);}do{vNewDate=new Date(vYear,vMonth,vDay);vDay--;}while(vNewDate.getMonth()!=vMonth)return vNewDate;}function PDP_SplitDate(pDate,pAO,pPName){var vR=false;var vY=pDate!=null?pDate.getFullYear():null;var vM=pDate!=null?pDate.getMonth():null;var vD=pDate!=null?pDate.getDate():null;eval("if (pAO."+pPName+"Y!=vY){pAO."+pPName+"Y=vY;vR=true}");eval("if (pAO."+pPName+"M!=vM){pAO."+pPName+"M=vM;vR=true}");eval("if (pAO."+pPName+"D!=vD){pAO."+pPName+"D=vD;vR=true}");return vR;}function PDP_GetWeekNum(pDate,pRule,pFDOW){var vDate1=PDP_GetFirstWeekNumDate(pDate.getUTCFullYear(),pRule,pFDOW);var vWkNum=Math.round(1+((pDate-vDate1)/(86400000*7)));if(vWkNum>52){var vDate2=PDP_GetFirstWeekNumDate(pDate.getUTCFullYear()+1,pRule,pFDOW);if(vDate2<=pDate)vWkNum=1;}return vWkNum;}function PDP_GetFirstWeekNumDate(pYear,pRule,pFDOW){var vDate=PDP_MakeUTCDate(pYear,0,1);var vDOW=vDate.getUTCDay();switch(pRule){case 0:if(vDOW==pFDOW)return vDate;else{var vUTC=vDate.valueOf();if(pFDOW>vDOW)vUTC=vUTC-((vDOW-pFDOW+7)*86400000);else vUTC=vUTC-((vDOW-pFDOW)*86400000);return new Date(vUTC);}break;case 1:if(vDOW==pFDOW)return vDate;else return PDP_MakeUTCDate(pYear,0,1+(pFDOW+7-vDOW));break;default:if(pFDOW>3)pFDOW=pFDOW+4;if(vDOW<=pFDOW+3){if(vDOW==pFDOW)return vDate;else return PDP_MakeUTCDate(pYear,0,1+(pFDOW-vDOW));}else return PDP_MakeUTCDate(pYear,0,1+(pFDOW+7-vDOW));break;}}function PDP_RelocatePopup(pPF){if(window.gPDP_InCB)alert("Calling PDP_RelocatePopup from within a callback");var vPN=pPF.parentNode;if((vPN!=null)&&(vPN!=document.body)&&(vPN.tagName!="FORM")&&(window.__smartNav==null)){if((document.body.removeChild!=null)&&((document.body.appendChild!=null)||(document.body.outerHTML!=null))){var vMoving=vPN.removeChild(pPF);var vPH=PDP_GetById('PDP_Popups');if(vPH.insertAdjacentElement)vPH.insertAdjacentElement("afterEnd",vMoving);else vPH.parentNode.insertBefore(vMoving,vPH.nextSibling);pPF=PDP_GetById(pPF.id);}}return pPF;}